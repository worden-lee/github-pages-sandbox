{"":{"0":{"attributes":{"filename":"printable.Rout.pdf","linktext":"the nomogram"},"source":false,"position":[[626,694]]},"bf0656720ab83fcb04a5415a2b35a14d.tex-math":{"attributes":{"filename":"bf0656720ab83fcb04a5415a2b35a14d.tex-math","standalone":"yes"},"content":"\\pm b","source":true,"position":[[786,887]]},"4a8a08f09d37b73795649038408b5f33.tex-math":{"attributes":{"filename":"4a8a08f09d37b73795649038408b5f33.tex-math","standalone":"yes"},"content":"c","source":true,"position":[[892,989],[1359,1456],[1627,1724]]},"1":{"attributes":{"filename":"example.Rout.png"},"source":false,"position":[[1017,1059]]},"fb7e65ce9c8bf043f622f48b5bda4db7.tex-math":{"attributes":{"filename":"fb7e65ce9c8bf043f622f48b5bda4db7.tex-math","standalone":"yes"},"content":"x^2-3x-5=0","source":true,"position":[[1120,1226]]},"92eb5ffee6ae2fec3ad71c777531578f.tex-math":{"attributes":{"filename":"92eb5ffee6ae2fec3ad71c777531578f.tex-math","standalone":"yes"},"content":"b","source":true,"position":[[1257,1354],[3307,3404]]},"15e4235e578d96be98a6c3f8a346a52c.tex-math":{"attributes":{"filename":"15e4235e578d96be98a6c3f8a346a52c.tex-math","standalone":"yes"},"content":"-b","source":true,"position":[[1524,1622]]},"2":{"attributes":{"filename":"another.Rout.png"},"source":false,"position":[[1766,1808]]},"f6ceb0e7de7a39451902195c5dfb9635.tex-math":{"attributes":{"filename":"f6ceb0e7de7a39451902195c5dfb9635.tex-math","standalone":"yes"},"content":"x^2-5x+1 = 0","source":true,"position":[[1832,1940]]},"eac9a477dc5c519ad97b940fc68aed0a.tex-math":{"attributes":{"filename":"eac9a477dc5c519ad97b940fc68aed0a.tex-math","standalone":"yes"},"content":"(0, b)","source":true,"position":[[2081,2183]]},"88eaaeb0e47036f7c4453377d6ebd869.tex-math":{"attributes":{"filename":"88eaaeb0e47036f7c4453377d6ebd869.tex-math","standalone":"yes"},"content":"(1, c)","source":true,"position":[[2188,2290]]},"4b43b0aee35624cd95b910189b3dc231.tex-math":{"attributes":{"filename":"4b43b0aee35624cd95b910189b3dc231.tex-math","standalone":"yes"},"content":"r","source":true,"position":[[2336,2433],[2442,2539],[3151,3248]]},"e0c6ef127a6888419edcb5345f2dd0fa.tex-math":{"attributes":{"filename":"e0c6ef127a6888419edcb5345f2dd0fa.tex-math","standalone":"yes"},"content":"r^2+br+c=0","source":true,"position":[[2563,2669]]},"bb7cc75db70e9440f5f2de037f525a18.tex-math":{"attributes":{"filename":"bb7cc75db70e9440f5f2de037f525a18.tex-math","standalone":"yes"},"content":"y=b+(c-b)x","source":true,"position":[[2702,2808]]},"f7fd8e46cc68d6e210ab4d37ba4a4b4f.tex-math":{"attributes":{"filename":"f7fd8e46cc68d6e210ab4d37ba4a4b4f.tex-math","standalone":"yes"},"content":"c=-r^2-br","source":true,"position":[[2842,2947]]},"2d7a6df7585e060bb8223ea68486d598.tex-math":{"attributes":{"filename":"2d7a6df7585e060bb8223ea68486d598.tex-math","standalone":"yes"},"content":"y=b-(r^2+br+b)x","source":true,"position":[[2995,3106]]},"4373227dfe87acbbb81e72418d62d02d.tex-math":{"attributes":{"filename":"4373227dfe87acbbb81e72418d62d02d.tex-math","standalone":"yes"},"content":"x=1\/(r+1)","source":true,"position":[[3430,3535]]},"8e7488547c9fa28f8221bdfa47456833.tex-math":{"attributes":{"filename":"8e7488547c9fa28f8221bdfa47456833.tex-math","standalone":"yes"},"content":"y=-r^2\/(r+1)","source":true,"position":[[3547,3655]]},"nomogram.R":{"attributes":{"filename":"nomogram.R","display":"source"},"content":"dev.off()\npdf(height=9.5, width=6.5)\nnomogram <- function(xoff=0.1, asp=1\/16){\n\tplot(NULL, NULL, asp=asp,\n\t\tmain = expression(x**2 %+-% bx + c == 0),\n\t\txlim=c(-xoff, 1+xoff), ylim=c(-10,10), axes=FALSE,\n\t\txaxs=\"i\", yaxs=\"i\",\n\t\txlab=\"\", ylab=\"\"\n\t)\n\n\tvertical_axis <- function(pos, side=2){\n\t\taxis(side, pos=pos, at=-10:10)\n\t\taxis(side, pos=pos, at= seq(-10, 10, by=0.5), \n\t\t\tlabels=FALSE, tcl=-0.4)\n\t\taxis(side, pos=pos, at= seq(-10, 10, by=0.1), \n\t\t\tlabels=FALSE, tcl=-0.2)\n\t}\n\n\tvertical_axis(0)\n\tvertical_axis(1, 4)\n\ttext(0.05, 9, \"b\")\n\ttext(0.95, 9, \"c\")\n\n\tr = seq(0, 10, length.out=1001)\n\tlines(1\/(r+1), -r^2\/(r+1))\n\n\trticks <- function(r, tcl, asp=1, labels=FALSE, ll=0.9){\n\t\tx <- 1\/(r+1)\n\t\ty <- -r^2\/(r+1)\n\t\tyx <- (r^2+2*r)*asp\n\t\trad <- sqrt(1+yx^2)\n\t\txp <- 1\/(asp*rad)\n\t\typ <- yx\/rad\n\t\tx0 <- x+yp*tcl\/2\n\t\tx1 <- x-yp*tcl\/2\n\t\ty0 <- y-xp*tcl\/2\n\t\ty1 <- y+xp*tcl\/2\n\t\tarrows(x0, y0, x1, y1, length=0)\n\t\tif(labels){\n\t\t\ttext(x-ll*yp*tcl, y+ll*xp*tcl, r)\n\t\t}\n\t}\n\n\trticks(seq(1, 10, by=1), 0.08, asp, labels=TRUE)\n\trticks(seq(0, 10, by=0.5), 0.05, asp)\n\trticks(seq(0, 4, by=0.1), 0.03, asp)\n\trticks(seq(4, 10, by=0.25), 0.04, asp)\n}\n\nnomogram()\n","source":true,"position":[[3714,4921]]},"example.mk":{"attributes":{"filename":"example.mk","display":"source"},"content":"example.Rout: nomogram.RData example.R\n","source":true,"position":[[5117,5222]]},"example.R":{"attributes":{"filename":"example.R","display":"source"},"content":"eqLines <- function(a, b){\n\tabline(a, b-a, lty=2, lwd=1.5)\n\tabline(-a, b+a, lty=3, lwd=1.5)\n}\nnomogram()\neqLines(-3, -5)\n","source":true,"position":[[5279,5465]]},"another.mk":{"attributes":{"filename":"another.mk","display":"source"},"content":"another.Rout: example.RData\n","source":true,"position":[[5493,5587]]},"another.R":{"attributes":{"filename":"another.R","display":"source"},"content":"nomogram()\neqLines(-5, 1)\n","source":true,"position":[[5590,5681]]},"printable.mk":{"attributes":{"filename":"printable.mk","display":"source"},"content":"printable.Rout: nomogram.Rout\n","source":true,"position":[[5706,5804]]},"printable.R":{"attributes":{"filename":"printable.R","display":"source"},"content":"# setpdf(height=9.5, width=6.5) # This is a theobio\/Rprep magic command\nnomogram()\n","source":true,"position":[[5807,5957]]}},"cache-filled":true}
[[626,694,"",0],[786,887,"","bf0656720ab83fcb04a5415a2b35a14d.tex-math"],[892,989,"","4a8a08f09d37b73795649038408b5f33.tex-math"],[1017,1059,"",1],[1120,1226,"","fb7e65ce9c8bf043f622f48b5bda4db7.tex-math"],[1257,1354,"","92eb5ffee6ae2fec3ad71c777531578f.tex-math"],[1359,1456,"","4a8a08f09d37b73795649038408b5f33.tex-math"],[1524,1622,"","15e4235e578d96be98a6c3f8a346a52c.tex-math"],[1627,1724,"","4a8a08f09d37b73795649038408b5f33.tex-math"],[1766,1808,"",2],[1832,1940,"","f6ceb0e7de7a39451902195c5dfb9635.tex-math"],[2081,2183,"","eac9a477dc5c519ad97b940fc68aed0a.tex-math"],[2188,2290,"","88eaaeb0e47036f7c4453377d6ebd869.tex-math"],[2336,2433,"","4b43b0aee35624cd95b910189b3dc231.tex-math"],[2442,2539,"","4b43b0aee35624cd95b910189b3dc231.tex-math"],[2563,2669,"","e0c6ef127a6888419edcb5345f2dd0fa.tex-math"],[2702,2808,"","bb7cc75db70e9440f5f2de037f525a18.tex-math"],[2842,2947,"","f7fd8e46cc68d6e210ab4d37ba4a4b4f.tex-math"],[2995,3106,"","2d7a6df7585e060bb8223ea68486d598.tex-math"],[3151,3248,"","4b43b0aee35624cd95b910189b3dc231.tex-math"],[3307,3404,"","92eb5ffee6ae2fec3ad71c777531578f.tex-math"],[3430,3535,"","4373227dfe87acbbb81e72418d62d02d.tex-math"],[3547,3655,"","8e7488547c9fa28f8221bdfa47456833.tex-math"],[3714,4921,"","nomogram.R"],[5117,5222,"","example.mk"],[5279,5465,"","example.R"],[5493,5587,"","another.mk"],[5590,5681,"","another.R"],[5706,5804,"","printable.mk"],[5807,5957,"","printable.R"]]
keep text: ---
layout: post
title:  "Nomogram"
date:   2014-10-15 19:00:01
categories: jekyll update
---
<h2> Intro </h2>

[This is <a href="http://lalashan.mcmaster.ca/theobio/math/index.php/Nomogram">a page from Jonathan Dushoff's math wiki</a>, adapted for use as a test of my Working Markup blog-post system. -lw]
<p>
On this page, I use the free software environment <a href="http://www.r-project.org/">R</a> to construct a <a href="http://en.wikipedia.org/wiki/Nomogram">nomogram</a> that I read about in a recreational math book when I was a kid.  This nomogram solves quadratic equations.

<h2> Nomogram </h2>

You can print out 
token: UNIQ-WW-1180946952-QINU
keep text: , and use a ruler to read off the solutions to the quadratic equation, where the line from 
token: UNIQ-WW-2105515289-QINU
keep text:  to 
token: UNIQ-WW-271463652-QINU
keep text:  intersects the scale.

<p>
token: UNIQ-WW-918873961-QINU
keep text: </p>

The example above shows the solutions to the equation 
token: UNIQ-WW-2027933211-QINU
keep text: .  The dashed line connecting 
token: UNIQ-WW-1254507595-QINU
keep text:  to 
token: UNIQ-WW-366576356-QINU
keep text:  shows the positive solution (4.2), and the dotted line connecting 
token: UNIQ-WW-671678574-QINU
keep text:  to 
token: UNIQ-WW-1642054979-QINU
keep text:  shows the negative solution (-1.2).

<p>
token: UNIQ-WW-1097740052-QINU
keep text: </p>

In this example (
token: UNIQ-WW-836065568-QINU
keep text: ), both solutions are positive (0.2 and 4.8), thus only the dashed line intersects the scale.

<h2> Math </h2> 

We want to draw lines from 
token: UNIQ-WW-1682210477-QINU
keep text:  to 
token: UNIQ-WW-1824659008-QINU
keep text:  that will pass through a point labeled with 
token: UNIQ-WW-1777600625-QINU
keep text: , where 
token: UNIQ-WW-522472310-QINU
keep text:  is a root, satisfying 
token: UNIQ-WW-73486704-QINU
keep text: .  The equation for our line is 
token: UNIQ-WW-1081182626-QINU
keep text: .  Solve the quadratic to obtain 
token: UNIQ-WW-1960986525-QINU
keep text: , and substitute into the line equation to get 
token: UNIQ-WW-391288371-QINU
keep text: .
<p>
If we want all lines corresponding to 
token: UNIQ-WW-1902076983-QINU
keep text:  to go through our point, we must find one independent of 
token: UNIQ-WW-743120679-QINU
keep text: .  We do this by setting 
token: UNIQ-WW-2100739416-QINU
keep text: , to yield 
token: UNIQ-WW-1893358500-QINU
keep text: .

<h2> Code </h2>

Define and call a nomogram function.


token: UNIQ-WW-1315399729-QINU
keep text: 

Use make to make the example code below depend on the R environment from above (using our <a href="http://lalashan.mcmaster.ca/theobio/projects/index.php/Theobio/R_rules">custom R rules</a>).


token: UNIQ-WW-1692029667-QINU
keep text: 

Make a nomogram, then define and make example lines.


token: UNIQ-WW-674645548-QINU
keep text: 

Here's another example.


token: UNIQ-WW-41995462-QINU
keep text: 


token: UNIQ-WW-1753603918-QINU
keep text: 

<h2> Printable </h2>


token: UNIQ-WW-464854308-QINU
keep text: 


token: UNIQ-WW-1881556024-QINU
